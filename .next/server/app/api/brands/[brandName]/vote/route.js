"use strict";(()=>{var e={};e.id=4308,e.ids=[4308],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},9262:(e,o,t)=>{t.r(o),t.d(o,{headerHooks:()=>p,originalPathname:()=>b,patchFetch:()=>j,requestAsyncStorage:()=>v,routeModule:()=>l,serverHooks:()=>y,staticGenerationAsyncStorage:()=>i,staticGenerationBailout:()=>h});var r={};t.r(r),t.d(r,{DELETE:()=>u,GET:()=>c,POST:()=>_});var n=t(5419),s=t(9108),a=t(9678),m=t(8070);let d={"royal-canin":{recommend_yes:1247,recommend_no:358,total_votes:1605,user_votes:{}},hills:{recommend_yes:892,recommend_no:201,total_votes:1093,user_votes:{}},orijen:{recommend_yes:456,recommend_no:89,total_votes:545,user_votes:{}},acana:{recommend_yes:234,recommend_no:67,total_votes:301,user_votes:{}}};async function c(e,{params:o}){try{let e=decodeURIComponent(o.brandName);if(!d[e])return m.Z.json({error:"브랜드를 찾을 수 없습니다."},{status:404});let t=d[e],r=Math.round(t.recommend_yes/t.total_votes*100);return m.Z.json({brandName:e,recommend_yes:t.recommend_yes,recommend_no:t.recommend_no,total_votes:t.total_votes,recommendation_percentage:r})}catch(e){return console.error("투표 데이터 조회 오류:",e),m.Z.json({error:"서버 오류가 발생했습니다."},{status:500})}}async function _(e,{params:o}){try{let t=decodeURIComponent(o.brandName),{vote:r,userId:n}=await e.json();if(d[t]||(d[t]={recommend_yes:0,recommend_no:0,total_votes:0,user_votes:{}}),!r||!n||!["yes","no"].includes(r))return m.Z.json({error:"잘못된 요청입니다."},{status:400});let s=d[t],a=s.user_votes[n];a&&("yes"===a?s.recommend_yes=Math.max(0,s.recommend_yes-1):s.recommend_no=Math.max(0,s.recommend_no-1),s.total_votes=Math.max(0,s.total_votes-1)),"yes"===r?s.recommend_yes+=1:s.recommend_no+=1,s.total_votes+=1,s.user_votes[n]=r;let c=Math.round(s.recommend_yes/s.total_votes*100);return m.Z.json({success:!0,brandName:t,recommend_yes:s.recommend_yes,recommend_no:s.recommend_no,total_votes:s.total_votes,recommendation_percentage:c,user_vote:r})}catch(e){return console.error("투표 저장 오류:",e),m.Z.json({error:"서버 오류가 발생했습니다."},{status:500})}}async function u(e,{params:o}){try{let t=decodeURIComponent(o.brandName),{userId:r}=await e.json();if(!d[t]||!r)return m.Z.json({error:"잘못된 요청입니다."},{status:400});let n=d[t],s=n.user_votes[r];s&&("yes"===s?n.recommend_yes=Math.max(0,n.recommend_yes-1):n.recommend_no=Math.max(0,n.recommend_no-1),n.total_votes=Math.max(0,n.total_votes-1),delete n.user_votes[r]);let a=n.total_votes>0?Math.round(n.recommend_yes/n.total_votes*100):0;return m.Z.json({success:!0,brandName:t,recommend_yes:n.recommend_yes,recommend_no:n.recommend_no,total_votes:n.total_votes,recommendation_percentage:a,user_vote:null})}catch(e){return console.error("투표 삭제 오류:",e),m.Z.json({error:"서버 오류가 발생했습니다."},{status:500})}}let l=new n.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/brands/[brandName]/vote/route",pathname:"/api/brands/[brandName]/vote",filename:"route",bundlePath:"app/api/brands/[brandName]/vote/route"},resolvedPagePath:"/Users/doheekong/Downloads/spf_cursor_test/app/api/brands/[brandName]/vote/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:v,staticGenerationAsyncStorage:i,serverHooks:y,headerHooks:p,staticGenerationBailout:h}=l,b="/api/brands/[brandName]/vote/route";function j(){return(0,a.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:i})}}};var o=require("../../../../../webpack-runtime.js");o.C(e);var t=e=>o(o.s=e),r=o.X(0,[1638,6206],()=>t(9262));module.exports=r})();