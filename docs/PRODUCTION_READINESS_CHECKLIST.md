# 🚀 상용 배포 전 점검 체크리스트

**작성일**: 2024-12-XX  
**버전**: 1.0.0  
**점검 범위**: 전체 애플리케이션

---

## ✅ 1. 버그 확인

### 1.1 빌드 오류
- ✅ **빌드 성공**: `npm run build` 완료, 오류 없음
- ✅ **모든 페이지 컴파일**: 46개 페이지 모두 정상 컴파일
- ✅ **동적 라우트**: `/owners/[ownerId]/pets/[petId]`, `/brands/[brandName]` 등 정상 작동

### 1.2 런타임 오류
- ✅ **framer-motion 모듈 오류 해결**: 캐시 삭제 후 재빌드 완료
- ✅ **로그인 버튼 상태 관리**: 각 버튼별 독립적인 로딩 상태 적용 완료
- ⚠️ **에러 핸들링**: 일부 페이지에서 try-catch 블록은 있으나 사용자 친화적 에러 메시지 개선 필요

### 1.3 알려진 이슈
- ⚠️ **TODO 항목**: 일부 기능이 TODO로 남아있음 (아래 개선 필요 항목 참조)
- ⚠️ **콘솔 로그**: 프로덕션에서 제거 필요 (`console.log`, `console.error`)

---

## ✅ 2. 페이지 연동 확인

### 2.1 네비게이션 구조
- ✅ **Header 네비게이션**: 모든 카테고리 메뉴 정상 작동
- ✅ **404 페이지**: 존재하지 않는 페이지 접근 시 정상 리다이렉트
- ✅ **인증 플로우**: 로그인 → 프로필 → 설정 페이지 연동 정상

### 2.2 주요 페이지 연동
| 페이지 | 상태 | 연동 확인 |
|--------|------|----------|
| `/` (홈) | ✅ | 모든 링크 정상 작동 |
| `/login` | ✅ | 로그인 후 리다이렉트 정상 |
| `/signup` | ✅ | 회원가입 플로우 정상 |
| `/profile` | ✅ | 마이페이지 접근 정상 |
| `/brands` | ✅ | 브랜드 목록 → 상세 → 평가 연동 정상 |
| `/pet-log` | ✅ | 펫 로그 목록 → 상세 연동 정상 |
| `/owners/[ownerId]/pets/[petId]` | ✅ | 동적 라우트 정상 작동 |
| `/admin/*` | ✅ | 관리자 페이지 접근 제어 정상 |

### 2.3 API 연동
- ✅ **Supabase 연동**: 인증, 데이터베이스 쿼리 정상 작동
- ✅ **Admin API**: 권한 확인 및 데이터 조회 정상
- ⚠️ **에러 핸들링**: API 실패 시 사용자 친화적 메시지 개선 필요

---

## ⚠️ 3. 개선이 필요한 페이지

### 3.1 기능 미완성 (TODO 항목)

#### 🔴 높은 우선순위
1. **프로필 페이지** (`app/profile/page.tsx`)
   - ⚠️ 이미지 업로드 기능 미구현 (TODO 주석 존재)
   - **권장**: 프로필 이미지 업로드 기능 구현 또는 제거

2. **설정 페이지** (`app/settings/page.tsx`)
   - ⚠️ 설정 저장 로직 미구현 (TODO 주석 존재)
   - ⚠️ 계정 삭제 로직 미구현 (TODO 주석 존재)
   - **권장**: Supabase 연동 또는 기능 제거

3. **Admin 페이지들**
   - ⚠️ 일부 Admin 페이지에서 API 호출이 TODO로 남아있음
   - **권장**: 실제 API 연동 또는 Mock 데이터로 완성

#### 🟡 중간 우선순위
4. **펫 로그 기능**
   - ⚠️ 댓글 작성 기능 일부 TODO
   - ⚠️ 답글 기능 미구현
   - **권장**: 기능 완성 또는 UI에서 제거

5. **통계 데이터**
   - ⚠️ Admin 대시보드에서 변화율 계산이 TODO
   - **권장**: 실제 계산 로직 구현 또는 제거

### 3.2 사용자 경험 개선

#### 성능 최적화
- ⚠️ **로딩 시간**: Profile 페이지와 Pet-log 페이지 전환 시 로딩 시간 개선 필요
  - 원인: 중복 세션 확인 로직, 순차적 데이터 로딩
  - 권장: 병렬 데이터 로딩, 캐싱 전략 도입

#### 에러 메시지
- ⚠️ **일관성**: 에러 메시지 형식 통일 필요
- ⚠️ **사용자 친화성**: 기술적 에러 메시지를 사용자 친화적으로 변경

#### 모바일 반응형
- ✅ 대부분의 페이지 모바일 반응형 적용 완료
- ⚠️ 일부 폼 입력 필드 모바일에서 정렬 개선 필요

---

## 🔒 4. 보안 확인

### 4.1 인증 및 권한

#### ✅ 잘 구현된 부분
- ✅ **Supabase 인증**: OAuth (Google, Kakao), 이메일/비밀번호 로그인 정상 작동
- ✅ **Admin 권한 확인**: API 레벨에서 권한 확인 구현됨
- ✅ **세션 관리**: Supabase 세션 관리 정상 작동
- ✅ **API 보안**: Admin API에서 Bearer 토큰 검증 구현됨

#### ⚠️ 개선 필요
1. **환경 변수 보안**
   - ✅ `.gitignore`에 `.env.local` 포함됨
   - ⚠️ **프로덕션 환경 변수**: Vercel에서 환경 변수 설정 확인 필요
   - **권장**: 
     - `NEXT_PUBLIC_SUPABASE_URL` ✅ (공개 가능)
     - `NEXT_PUBLIC_SUPABASE_ANON_KEY` ✅ (공개 가능)
     - `SUPABASE_SERVICE_ROLE_KEY` ⚠️ (서버 사이드 전용, 절대 공개 금지)

2. **콘솔 로그 제거**
   - ⚠️ 프로덕션에서 `console.log`, `console.error` 제거 필요
   - **권장**: 환경 변수로 제어하거나 빌드 시 제거

3. **에러 메시지 노출**
   - ⚠️ 일부 API에서 상세한 에러 메시지가 클라이언트에 노출될 수 있음
   - **권장**: 일반적인 에러 메시지만 반환, 상세 정보는 서버 로그에만 기록

### 4.2 데이터 보안

#### ✅ 잘 구현된 부분
- ✅ **Row Level Security (RLS)**: Supabase RLS 활성화 (문서 확인 필요)
- ✅ **SQL Injection 방지**: Supabase 클라이언트 사용으로 자동 방지
- ✅ **XSS 방지**: React의 기본 XSS 방지 기능 활용

#### ⚠️ 확인 필요
1. **데이터 검증**
   - ⚠️ 클라이언트 사이드 검증만 있는 경우 서버 사이드 검증 추가 필요
   - **권장**: API 라우트에서 입력 데이터 검증 강화

2. **파일 업로드**
   - ⚠️ 파일 업로드 기능이 있는 경우 파일 타입 및 크기 제한 확인 필요
   - **권장**: 파일 검증 로직 추가

### 4.3 보안 헤더

#### ✅ 구현됨
- ✅ **Cache-Control**: API 라우트에 `no-cache, no-store, must-revalidate` 설정됨
- ✅ **Middleware**: Admin 라우트 보호 미들웨어 구현됨

#### ⚠️ 추가 권장
- ⚠️ **CSP (Content Security Policy)**: 추가 권장
- ⚠️ **HSTS**: HTTPS 강제 설정 권장
- ⚠️ **X-Frame-Options**: 클릭재킹 방지 헤더 추가 권장

---

## 📊 종합 평가

### ✅ 배포 가능 항목
- ✅ 빌드 오류 없음
- ✅ 주요 페이지 연동 정상
- ✅ 기본 인증/권한 시스템 작동
- ✅ 기본 보안 조치 적용됨

### ⚠️ 배포 전 권장 사항

#### 필수 (배포 전 반드시 처리)
1. **프로덕션 환경 변수 확인**
   - Vercel에서 모든 환경 변수 설정 확인
   - `SUPABASE_SERVICE_ROLE_KEY`는 서버 사이드 전용으로 설정

2. **콘솔 로그 제거**
   - 프로덕션 빌드에서 `console.log` 제거
   - 에러 로깅은 서버 사이드에서만

3. **TODO 항목 정리**
   - 미완성 기능 제거 또는 완성
   - TODO 주석이 있는 기능은 UI에서 숨기기

#### 권장 (배포 후 점진적 개선)
1. **성능 최적화**
   - 페이지 로딩 시간 개선
   - 이미지 최적화
   - 코드 스플리팅 최적화

2. **에러 핸들링 개선**
   - 사용자 친화적 에러 메시지
   - 에러 바운더리 추가
   - 에러 로깅 시스템 구축

3. **모니터링 설정**
   - 에러 추적 도구 연동 (Sentry 등)
   - 성능 모니터링
   - 사용자 분석 도구 연동

---

## 🎯 배포 체크리스트

### 배포 전 최종 확인
- [ ] Vercel 환경 변수 설정 확인
- [ ] 프로덕션 빌드 테스트 (`npm run build`)
- [ ] 주요 페이지 수동 테스트
- [ ] 로그인/로그아웃 플로우 테스트
- [ ] Admin 페이지 접근 테스트
- [ ] 모바일 반응형 테스트
- [ ] 에러 페이지 테스트 (404 등)

### 배포 후 확인
- [ ] 프로덕션 사이트 접근 확인
- [ ] 로그인 기능 테스트
- [ ] 주요 기능 동작 확인
- [ ] 에러 로그 모니터링
- [ ] 성능 지표 확인

---

## 📝 참고 문서

- [에러 핸들링 가이드](./ERROR_HANDLING_GUIDE.md)
- [보안 검토 보고서](./SECURITY_AUDIT_REPORT.md)
- [환경 변수 설정 가이드](./ENV_SETUP_QUICK_FIX.md)
- [Supabase 설정 가이드](./SUPABASE_SETUP.md)

---

**마지막 업데이트**: 2024-12-XX  
**작성자**: Safe Pet Food 개발팀

