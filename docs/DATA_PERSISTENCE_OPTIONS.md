# 데이터 영구 저장 옵션 가이드

## 🤔 현재 문제

**질문**: 관리자 패널에서 신규 데이터 등록하면 현재 등록되어 있는 목데이터는 어떻게 돼?

**답변**: 

### 현재 시스템 (JSON 파일 방식)

```
로컬 개발 환경:
✅ 목데이터 유지
✅ 신규 데이터도 파일에 저장됨
→ 데이터 영구 보존

프로덕션 환경 (Vercel):
✅ 목데이터 유지 (읽기 전용)
❌ 신규 데이터는 메모리에만 저장
❌ 서버 재시작 시 사라짐!
```

**근본 원인**: Vercel 같은 서버리스 환경에서는 파일 시스템이 **읽기 전용**

## 🎯 해결 방안 비교

| 방안 | 난이도 | 설정 시간 | 무료 티어 | 추천도 | 용도 |
|------|--------|----------|----------|--------|------|
| **Vercel KV** | ⭐ | 10분 | 256MB | ⭐️⭐️⭐️⭐️ | 빠른 시작 |
| **Vercel Postgres** | ⭐️⭐️ | 30분 | 60시간/월 | ⭐️⭐️⭐️⭐️⭐️ | 장기 운영 |
| **Supabase** | ⭐️⭐️ | 30분 | 500MB | ⭐️⭐️⭐️⭐️⭐️ | 완전 무료 |
| **PlanetScale** | ⭐️⭐️⭐️ | 45분 | 5GB | ⭐️⭐️⭐️⭐️ | 대용량 |

## 🚀 추천 순서

### 1. 지금 당장 해결하고 싶다면: **Vercel KV**

```bash
✅ 설정 10분
✅ 클릭 몇 번으로 완료
✅ 무료로 충분
✅ 목데이터 + 신규 데이터 모두 유지
```

**가이드**: `QUICK_KV_SETUP.md`

### 2. 제대로 구축하고 싶다면: **Vercel Postgres**

```bash
✅ 관계형 데이터베이스
✅ 복잡한 쿼리 가능
✅ 데이터 무결성 보장
✅ 확장성 우수
```

**가이드**: `DATABASE_MIGRATION_GUIDE.md`

### 3. 완전 무료로 시작하고 싶다면: **Supabase**

```bash
✅ 500MB 무료
✅ PostgreSQL 기반
✅ 실시간 기능
✅ 관리자 대시보드
```

**가이드**: `DATABASE_MIGRATION_GUIDE.md` (Supabase 섹션)

## 📊 상세 비교

### Option 1: Vercel KV (Redis) ⚡️

**장점:**
- 🚀 가장 빠른 설정 (10분)
- 💰 무료 티어 관대 (256MB)
- 🔧 설정 매우 간단
- 📦 JSON 구조 그대로 사용

**단점:**
- ❌ 복잡한 쿼리 어려움
- ❌ 관계형 데이터 처리 제한적
- ❌ 대용량 데이터 비효율적

**적합한 경우:**
- 빠르게 프로토타입 만들 때
- 간단한 CRUD만 필요할 때
- 데이터 양이 적을 때

**비용:**
```
Hobby: 무료 (256MB, 3,000 명령/일)
Pro: $1/월 (512MB, 30,000 명령/일)
```

---

### Option 2: Vercel Postgres 🐘

**장점:**
- ✅ 완전한 SQL 기능
- ✅ 트랜잭션 지원
- ✅ 복잡한 관계 처리
- ✅ Vercel 완벽 통합

**단점:**
- ⏰ 설정 시간 30분
- 📚 Prisma 학습 필요
- 💰 무료 제한 (60시간 컴퓨트/월)

**적합한 경우:**
- 장기 운영 계획
- 복잡한 데이터 관계
- 확장성 중요

**비용:**
```
Hobby: 무료 (60시간 컴퓨트/월, 256MB)
Pro: $20/월 (1000시간 컴퓨트, 30GB)
```

---

### Option 3: Supabase 🔥

**장점:**
- 💯 가장 관대한 무료 티어
- 🎨 관리자 UI 제공
- 📡 실시간 기능 내장
- 🔐 인증 시스템 포함

**단점:**
- 🌐 별도 서비스 (Vercel 외부)
- ⏰ 설정 시간 30분
- 🔧 추가 설정 필요

**적합한 경우:**
- 완전 무료로 시작
- 실시간 기능 필요
- 관리자 대시보드 활용

**비용:**
```
Free: $0 (500MB DB, 2GB 파일)
Pro: $25/월 (8GB DB, 100GB 파일)
```

---

### Option 4: PlanetScale 🌟

**장점:**
- 💾 가장 큰 무료 스토리지 (5GB)
- 🔀 DB 브랜치 기능 (Git처럼)
- 🚄 매우 빠른 성능
- 📈 무제한 연결

**단점:**
- 💰 유료 전환 시 비쌈 ($39/월)
- 🔧 브랜치 개념 학습 필요
- ⚠️ 외래키 제약 없음 (설계 주의)

**적합한 경우:**
- 대용량 데이터 예상
- Git 스타일 워크플로우
- 개발/프로덕션 분리

**비용:**
```
Hobby: $0 (5GB, 1억 row reads/월)
Scaler: $39/월 (10GB, 100억 row reads)
```

## 🎯 의사 결정 플로우차트

```
시작
  ↓
빠르게 시작하고 싶다? 
  ├─ YES → Vercel KV ⚡️
  └─ NO
      ↓
완전 무료가 중요하다?
  ├─ YES → Supabase 🔥
  └─ NO
      ↓
Vercel과 완벽 통합?
  ├─ YES → Vercel Postgres 🐘
  └─ NO → PlanetScale 🌟
```

## 📝 실전 예시

### 케이스 1: MVP 빠르게 만들기

```
목표: 2주 안에 배포
추천: Vercel KV
이유: 10분 설정, 즉시 사용
나중에: Postgres로 마이그레이션
```

### 케이스 2: 본격적인 서비스

```
목표: 안정적인 장기 운영
추천: Vercel Postgres
이유: 확장성, 데이터 무결성
비용: 월 $20 (합리적)
```

### 케이스 3: 비용 최소화

```
목표: 완전 무료로 시작
추천: Supabase
이유: 500MB 무료, 기능 풍부
단점: 별도 서비스 관리 필요
```

### 케이스 4: 대규모 서비스

```
목표: 월 100만 방문자 대응
추천: PlanetScale
이유: 5GB 무료, 무제한 연결
비용: 나중에 $39/월 (필요시)
```

## 🛠️ 구현 가이드

### 1단계: 옵션 선택

위 플로우차트 참고

### 2단계: 가이드 문서 확인

- **Vercel KV**: `QUICK_KV_SETUP.md`
- **Postgres/Supabase/PlanetScale**: `DATABASE_MIGRATION_GUIDE.md`

### 3단계: 설정 및 마이그레이션

각 가이드 문서의 단계별 지침 따라하기

### 4단계: 테스트

```bash
# 로컬 테스트
npm run dev

# 관리자 패널에서 데이터 추가
http://localhost:3000/admin/brands

# 페이지 새로고침 → 데이터 유지 확인
```

### 5단계: 프로덕션 배포

```bash
git add .
git commit -m "feat: 데이터베이스 연동"
git push origin main
```

## ⚠️ 주의사항

### 데이터 백업

```
중요! 프로덕션 배포 전 반드시:
1. 기존 JSON 데이터 백업
2. 테스트 환경에서 충분히 검증
3. 롤백 계획 수립
```

### 환경 변수

```
절대 Git에 커밋하지 말 것:
- .env.local
- .env
- 데이터베이스 인증 정보
```

### 단계적 마이그레이션

```
권장 순서:
1. 로컬에서 완전히 테스트
2. 스테이징 환경 배포 (있다면)
3. 프로덕션 배포
4. 모니터링 강화
```

## 📞 도움이 필요하면

1. **Vercel KV**: `QUICK_KV_SETUP.md`
2. **데이터베이스**: `DATABASE_MIGRATION_GUIDE.md`
3. **배포 관리**: `VERCEL_DEPLOYMENT_SETUP.md`

## 🎉 결론

**즉시 해결하고 싶다면**: 
→ **Vercel KV** (10분 설정)

**제대로 구축하고 싶다면**: 
→ **Vercel Postgres** (30분 설정)

**완전 무료로 시작하고 싶다면**: 
→ **Supabase** (30분 설정)

**어느 것을 선택하든 목데이터는 유지되고 신규 데이터도 영구 저장됩니다!** ✅

---

**작성일**: 2024년 10월

