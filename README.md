# Safe Pet Food 🐾

**우리 아이 사료 영양 계산기**

반려동물 사료의 보장성분표를 건물기준으로 계산하여 영양 점수를 제공하는 웹 애플리케이션입니다.

## 🎯 주요 기능

### 🧮 계산기 도구
- **사료 성분 계산기**: 사료의 보장성분표 입력 시 즉시 건물기준 영양소 계산
- **칼로리 & 급여량 계산기**: 반려동물 정보 기반 맞춤 급여량 계산
- **일일 음수량 계산기**: 체중, 주식 종류, 활동량을 고려한 정확한 음수량 계산

### 📊 분석 & 평가
- **등급 평가**: 단백질, 지방, 섬유질을 Good/So-so/Bad로 평가
- **종합 점수**: 0-100점 스케일의 종합 영양 점수 제공
- **브랜드 평가**: 다양한 사료 브랜드의 안전성과 사용자 리뷰

### 💬 커뮤니티 & 후기
- **제품 후기**: 고양이 모래, 간식 등 실제 사용자 후기 모음
- **공유 기능**: 결과를 이미지로 공유할 수 있는 소셜 기능
- **반응형 디자인**: 모바일과 데스크톱 모두 최적화된 UI

## 🛠 기술 스택

- **Frontend**: Next.js 14, React 18, TypeScript
- **Styling**: Tailwind CSS
- **Image Generation**: @vercel/og
- **Testing**: Jest, React Testing Library
- **Deployment**: Vercel

## 📊 계산 로직

### 사료 성분 계산기
#### 건물기준 계산
```
건물기준 영양소 = (조영양소 / (100 - 수분)) × 100
```

#### 등급 기준 (성견 기준)
- **단백질 (건물기준)**
  - Good: > 30%
  - So-so: 22-30%
  - Bad: < 22%

- **지방 (건물기준)**
  - Good: 15-25%
  - So-so: 10-15%
  - Bad: < 10% 또는 > 25%

- **섬유질 (건물기준)**
  - Good: < 5%
  - So-so: ≥ 5%

#### 종합 점수
```
점수 = ((단백질점수 + 지방점수 + 섬유질점수) / 9) × 100
Good = 3점, So-so = 2점, Bad = 1점
```

### 일일 음수량 계산기
#### 기본 계산 공식
```
기본 필요 수분량 = 체중(kg) × 60ml
```

#### 음식을 통한 수분 섭취량
- **건식 사료**: 급여량 × 10% (수분 함량)
- **습식 사료**: 급여량 × 80% (수분 함량)  
- **생식/화식**: 급여량 × 70% (수분 함량)

#### 활동량/날씨 보정 계수
- **활동량**
  - 매우 활동적: ×1.3
  - 보통: ×1.0
  - 비활동적: ×0.9

- **날씨/계절**
  - 덥고 건조: ×1.4
  - 보통: ×1.0
  - 춥고 실내: ×0.9

#### 최종 권장 음수량
```
최종 음수량 = (기본 필요량 × 보정계수) - 음식 수분량
```

## 🚀 시작하기

### 설치

```bash
npm install
```

### 개발 서버 실행

```bash
npm run dev
```

브라우저에서 [http://localhost:3000](http://localhost:3000)을 열어 확인하세요.

### 테스트 실행

```bash
# 단위 테스트 실행
npm test

# 테스트 감시 모드
npm run test:watch
```

### 빌드

```bash
npm run build
npm start
```

## 📁 프로젝트 구조

```
pawsitive-eats/
├── app/
│   ├── api/og/          # OG 이미지 생성 API
│   ├── globals.css      # 전역 스타일
│   ├── layout.tsx       # 루트 레이아웃
│   └── page.tsx         # 메인 계산기 페이지
├── __tests__/
│   └── calculator.test.ts # 계산 로직 테스트
├── jest.config.js       # Jest 설정
├── jest.setup.js        # Jest 초기화
└── README.md
```

## 🧪 테스트

이 프로젝트는 TDD(Test-Driven Development) 방식으로 개발되었습니다.

### 단위 테스트
- **사료 성분 계산기**
  - 건물기준 계산 로직
  - 영양소 등급 평가
  - 종합 점수 계산

- **음수량 계산기**
  - 기본 수분 필요량 계산
  - 음식별 수분 섭취량 계산
  - 활동량/날씨 보정 계수
  - 최종 권장 음수량 계산

### 통합 테스트
- 실제 사료 데이터를 사용한 전체 계산 플로우
- 다양한 반려동물 조건별 음수량 계산 검증

## 📱 사용법

### 🧮 사료 성분 계산기 (/nutrition-calculator)
1. **보장성분표 입력**: 사료 포장지의 보장성분표 수치를 입력합니다
   - 조단백 (%)
   - 조지방 (%)
   - 조섬유 (%)
   - 조회분 (%)
   - 수분 (%) - 필수

2. **실시간 결과 확인**: 입력과 동시에 우측 패널에서 결과를 확인합니다
   - 종합 점수 (0-100점)
   - 각 영양소별 건물기준 수치와 등급
   - 등급별 설명

### 💧 일일 음수량 계산기 (/water-calculator)
1. **반려동물 정보 입력**:
   - 반려동물 종류 (강아지/고양이)
   - 현재 체중 (kg)
   - 주식 종류 (건식/습식/생식)
   - 활동 수준 (선택사항)
   - 날씨/계절 (선택사항)

2. **음수량 확인 및 기록**:
   - 권장 일일 음수량 확인
   - 실시간 음수량 기록 및 진행률 추적
   - 음수량 늘리기 팁 확인

3. **결과 공유**: "결과 공유하기" 버튼으로 소셜 미디어에 공유할 수 있습니다

## ⚠️ 주의사항

- 본 결과는 일반적인 성견/성묘 기준이며, 참고용으로만 활용해주세요
- 전문적인 상담은 수의사와 상의하세요
- 특수한 건강 상태나 연령대의 반려동물은 별도 기준이 필요할 수 있습니다

## 🔧 개발 환경 설정

### 필수 요구사항
- Node.js 18.0.0 이상
- npm 또는 yarn

### 환경 변수
현재 환경 변수는 필요하지 않습니다.

## 📈 향후 계획

### Phase 1 (현재)
- ✅ 기본 영양 계산기
- ✅ 실시간 결과 표시
- ✅ 소셜 공유 기능

### Phase 2 (예정)
- 반려동물 프로필 기반 맞춤 평가
- 다양한 연령대/품종별 기준
- 사료 브랜드 데이터베이스

### Phase 3 (예정)
- 사용자 리뷰 시스템
- 수의사 검증 시스템
- 모바일 앱 개발

## 🤝 기여하기

1. Fork the Project
2. Create your Feature Branch (`git checkout -b feature/AmazingFeature`)
3. Commit your Changes (`git commit -m 'Add some AmazingFeature'`)
4. Push to the Branch (`git push origin feature/AmazingFeature`)
5. Open a Pull Request

## 📄 라이선스

이 프로젝트는 MIT 라이선스 하에 배포됩니다.

## 🚨 에러 핸들링 및 문제 해결

### 긴급 복구
문제가 발생했을 때 빠른 복구를 위한 스크립트:
```bash
./scripts/emergency-reset.sh
```

### 주요 문서
- **[.cursorrules](.cursorrules)**: 개발 가이드라인 및 실수 예방 규칙
- **[에러 핸들링 가이드](docs/ERROR_HANDLING_GUIDE.md)**: 상세한 오류 해결 방법

### 자주 발생하는 문제들

#### 1. 서버 시작 실패
```bash
# 캐시 삭제 후 재시작
rm -rf .next
npm run dev
```

#### 2. TypeScript 에러
- 실제 데이터 구조와 인터페이스 정의 확인
- `docs/ERROR_HANDLING_GUIDE.md` 참고

#### 3. 모듈 임포트 에러
- lucide-react 아이콘 개별 임포트 사용
- 서버 컴포넌트에서 클라이언트 컴포넌트 분리

### 개발 체크리스트
새 기능 개발 시:
- [ ] 데이터 구조 먼저 확인
- [ ] TypeScript 인터페이스 정의
- [ ] 에러 핸들링 추가
- [ ] 각 변경 후 즉시 테스트

## 📞 문의

프로젝트에 대한 문의나 제안사항이 있으시면 이슈를 생성해 주세요.

---

Made with ❤️ for pet parents everywhere 🐕🐱 

# Safe Pet Food 프로젝트

반려동물의 건강하고 행복한 생활을 위한 AI 기반 종합 서비스 플랫폼입니다.

## 🆕 새로 추가된 기능: 건강검진표 분석기

### 📋 기능 개요
- **PDF 업로드**: 건강검진 결과 PDF 파일을 드래그 앤 드롭으로 업로드
- **반려동물 정보 입력**: 정확한 분석을 위한 기본 정보 수집
- **AI 분석**: ChatGPT를 활용한 건강검진 결과 해석
- **시각적 리포트**: 주요 관찰 항목과 정상 항목을 구분하여 표시
- **수의사 질문 생성**: 관심 항목을 선택하면 수의사에게 물어볼 질문 자동 생성

### 🔧 기술 구현
- **Frontend**: Next.js 14, TypeScript, Tailwind CSS
- **Backend API**: Next.js API Routes
- **AI 연동**: OpenAI GPT-4 API
- **PDF 처리**: OCR 기능 (현재 시뮬레이션, 실제 구현 시 Google Cloud Vision API 권장)
- **데이터 파싱**: 정규식을 활용한 혈액검사 데이터 구조화

### 📁 파일 구조
```
app/
├── health-analyzer/
│   └── page.tsx              # 건강검진표 분석기 메인 페이지
├── api/
│   └── analyze-health/
│       └── route.ts          # 분석 API 엔드포인트
└── components/
    └── Footer.tsx            # 공통 Footer 컴포넌트
```

### 🎯 주요 특징
1. **단계별 진행**: PDF 업로드 → 정보 입력 → AI 분석 → 결과 확인
2. **안전성 우선**: 의료진단 대체 불가 경고 및 면책조항 명시
3. **사용자 친화적**: 직관적인 UI/UX와 상세한 설명 제공
4. **실용적 기능**: 수의사 질문 목록 생성 및 클립보드 복사

### 🔮 향후 개선 계획

#### 1. PDF 처리 고도화
- **OCR 엔진 연동**: Google Cloud Vision API 또는 AWS Textract
- **테이블 인식**: 복잡한 검사 결과표의 정확한 데이터 추출
- **다양한 포맷 지원**: 병원별 서로 다른 검진표 형식 대응

#### 2. AI 분석 정확도 향상
- **RAG 시스템**: 수의학 지식 베이스 구축 및 검색 증강 생성
- **품종별 특화**: 견종/묘종별 정상 수치 범위 및 유전적 취약점 고려
- **연령별 보정**: 나이에 따른 정상 수치 범위 조정

#### 3. 데이터베이스 및 사용자 관리
- **분석 이력 저장**: 과거 검진 결과와 비교 분석
- **사용자 계정**: 반려동물별 건강 관리 프로필
- **추세 분석**: 시간에 따른 건강 지표 변화 추적

#### 4. 고급 기능
- **수의사 연결**: 지역별 수의사 추천 및 예약 연결
- **알림 시스템**: 정기 검진 알림 및 이상 수치 모니터링
- **리포트 내보내기**: PDF, 이메일 전송 기능

#### 5. 보안 및 규정 준수
- **개인정보 보호**: HIPAA 수준의 의료 데이터 보안
- **데이터 암호화**: 업로드된 PDF 및 분석 결과 암호화 저장
- **접근 권한 관리**: 사용자별 데이터 접근 제어

### 🛠 개발 환경 설정

#### 환경 변수 설정
```bash
# .env.local 파일 생성
OPENAI_API_KEY=your_openai_api_key_here
```

#### 의존성 설치 및 실행
```bash
npm install
npm run dev
```

#### API 테스트
```bash
# 건강검진표 분석 API 테스트
curl -X POST http://localhost:3000/api/analyze-health \
  -F "files=@sample_health_report.pdf" \
  -F 'petInfo={"type":"dog","breed":"말티즈","age":"5","ageUnit":"years","gender":"male","neutered":true,"conditions":"","concerns":""}'
```

### 📊 현재 구현 상태
- ✅ 프론트엔드 UI/UX 완성
- ✅ API 엔드포인트 구현
- ✅ 모의 데이터 분석 로직
- ✅ 에러 처리 및 폴백 시스템
- ⏳ 실제 PDF OCR 연동 (구현 대기)
- ⏳ OpenAI API 연동 (API 키 설정 필요)
- ⏳ 데이터베이스 연동 (향후 계획)

### 🎨 UI/UX 특징
- **반응형 디자인**: 모바일, 태블릿, 데스크톱 모든 환경 지원
- **진행 상태 표시**: 4단계 프로세스 시각화
- **드래그 앤 드롭**: 직관적인 파일 업로드
- **색상 코딩**: 심각도에 따른 시각적 구분 (빨강: 높음, 노랑: 중간, 파랑: 낮음)
- **접근성**: 스크린 리더 및 키보드 내비게이션 지원

---

## 기존 기능들

### 🏠 메인 기능
- **사료 성분 계산기**: AI 기반 사료 성분 분석
- **칼로리 계산기**: 반려동물별 적정 칼로리 계산
- **브랜드 평가**: 사료 브랜드 안전성 평가
- **커뮤니티**: 집사들의 정보 공유 공간

### 🔧 기술 스택
- **Frontend**: Next.js 14, TypeScript, Tailwind CSS
- **UI Components**: Lucide React Icons
- **Styling**: 반응형 디자인, 다크/라이트 모드
- **State Management**: React Hooks

### 📱 페이지 구조
- `/` - 메인 홈페이지
- `/login` - 로그인 페이지
- `/signup` - 회원가입 페이지
- `/health-analyzer` - 건강검진표 분석기 (신규)
- `/admin` - 관리자 패널
- `/admin/products` - 제품 관리
- `/admin/users` - 사용자 관리

### 🎯 주요 특징
- **관리자 시스템**: 제품, 사용자, 브랜드 관리
- **반응형 헤더**: 카테고리별 드롭다운 메뉴
- **Footer 통합**: 모든 페이지에 일관된 Footer
- **안전한 라우팅**: 페이지별 권한 관리

## 개발 가이드

### 설치 및 실행
```bash
npm install
npm run dev
```

### 프로젝트 구조
```
app/
├── page.tsx                 # 메인 홈페이지
├── login/page.tsx           # 로그인 페이지
├── signup/page.tsx          # 회원가입 페이지
├── health-analyzer/page.tsx # 건강검진표 분석기
├── admin/                   # 관리자 패널
├── api/                     # API 엔드포인트
└── components/              # 공통 컴포넌트
```

### 개발 시 주의사항
- `.cursorrules` 파일의 가이드라인 준수
- JSX 문법 오류 방지
- 파일 끝 태그 오염 방지
- 다중 포트 충돌 방지

## 라이선스
MIT License 

# Safe Pet Food - 반려동물 건강 관리 플랫폼

반려동물의 건강한 삶을 위한 종합 관리 플랫폼입니다.

## 🚀 기능

- **사료 성분 분석**: 보장성분표 기반 영양 점수 계산
- **칼로리 & 급여량 계산**: 반려동물 맞춤 급여량 계산
- **건강검진표 AI 분석**: ChatGPT API를 활용한 검진 결과 분석
- **음수량 계산**: 적정 일일 음수량 계산
- **브랜드 평가**: 사료 브랜드 안전성 평가
- **AI 상담**: 반려동물 건강 관련 AI 상담

## 🔧 설정

### 환경 변수 설정

프로젝트 루트에 `.env.local` 파일을 생성하고 다음 내용을 추가하세요:

```bash
# OpenAI API Key for health analysis
OPENAI_API_KEY=your_openai_api_key_here
```

### OpenAI API 키 발급

1. [OpenAI Platform](https://platform.openai.com/api-keys)에 접속
2. 계정 생성 또는 로그인
3. API Keys 섹션에서 새 API 키 생성
4. 생성된 키를 `.env.local` 파일에 추가

## 💻 개발 환경 실행

```bash
npm install
npm run dev
```

브라우저에서 `http://localhost:3000`으로 접속

## 🏥 건강검진표 분석기 테스트

1. `/health-analyzer` 페이지 접속
2. 반려동물 정보 입력
3. PDF 파일 업로드 (현재는 모의 데이터 사용)
4. ChatGPT API를 통한 실시간 분석 결과 확인

## 📋 주요 페이지

- `/` - 메인 홈페이지
- `/nutrition-calculator` - 사료 성분 분석
- `/calorie-calculator` - 칼로리 계산기
- `/health-analyzer` - 건강검진표 분석 (ChatGPT API 연동)
- `/water-calculator` - 음수량 계산기
- `/brands` - 브랜드 평가
- `/chat` - AI 상담

## 🔒 보안 주의사항

- API 키는 절대 공개 저장소에 커밋하지 마세요
- `.env.local` 파일은 `.gitignore`에 포함되어 있습니다
- 프로덕션 환경에서는 환경 변수를 안전하게 관리하세요 